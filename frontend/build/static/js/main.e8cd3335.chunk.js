(this.webpackJsonpmesto=this.webpackJsonpmesto||[]).push([[0],{28:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),s=n.n(c),i=n(30),o=n.n(i),r=(n(28),n(17)),u=n.n(r),l=n(33),d=n(25),p=n(2),b=n(4),m=s.a.createContext(),j=n(12),h=n(31),O={baseUrl:"http://localhost:3001/",headers:{"Content-Type":"application/json"},credentials:"include"},f=new(function(){function e(t){Object(j.a)(this,e),this._url=t.baseUrl,this._headers=t.headers,this._credentials=t.credentials}return Object(h.a)(e,[{key:"_sendRequest",value:function(e,t){return fetch("".concat(this._url).concat(e),t).then((function(e){return e.ok?e.json():Promise.reject(e.status)}))}},{key:"getUserInfo",value:function(){return this._sendRequest("users/me",{headers:this._headers,credentials:this._credentials})}},{key:"getInitialCards",value:function(){return this._sendRequest("cards",{headers:this._headers,credentials:this._credentials})}},{key:"updateUserInfo",value:function(e){return this._sendRequest("users/me",{method:"PATCH",headers:this._headers,credentials:this._credentials,body:JSON.stringify({name:e.name,about:e.about})})}},{key:"addNewCard",value:function(e){return this._sendRequest("cards",{method:"POST",headers:this._headers,credentials:this._credentials,body:JSON.stringify({name:e.name,link:e.link})})}},{key:"changeLikeCardStatus",value:function(e,t){return this._sendRequest("cards/".concat(e,"/likes"),{method:"".concat(t?"PUT":"DELETE"),headers:this._headers,credentials:this._credentials})}},{key:"deleteCard",value:function(e){return this._sendRequest("cards/".concat(e),{method:"DELETE",headers:this._headers,credentials:this._credentials})}},{key:"updateUserAvatar",value:function(e){return this._sendRequest("users/me/avatar",{method:"PATCH",headers:this._headers,credentials:this._credentials,body:JSON.stringify({avatar:e})})}}]),e}())(O),_=n(10),x=n.p+"static/media/logo.2e17206c.svg";var g=function(e){var t=e.email,n=e.signOut;return Object(a.jsxs)("div",{className:"header__auth-info",children:[Object(a.jsx)("span",{className:"header__mail",children:t}),Object(a.jsx)("button",{className:"header__button",onClick:n,children:"\u0412\u044b\u0439\u0442\u0438"})]})};var v=function(e){var t=e.isAuthInfoOpened,n=e.onHamburgerClick,c="hamburger\n\t".concat(t?"hamburger_opened":"hamburger_closed");return Object(a.jsx)("button",{className:c,onClick:n,children:Object(a.jsx)("span",{})})};var C=function(e){var t=e.loggedIn,n=e.email,c=e.signOut,s=e.isAuthInfoOpened,i=e.onHamburgerClick,o=Object(b.h)().pathname,r="".concat("/sign-in"===o?"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f":"\u0412\u043e\u0439\u0442\u0438"),u="".concat("/sign-in"===o?"/sign-up":"/sign-in");return Object(a.jsxs)("header",{className:"header",children:[Object(a.jsx)("img",{src:x,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0441\u0430\u0439\u0442\u0430",className:"logo"}),t?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(g,{email:n,signOut:c}),Object(a.jsx)(v,{isAuthInfoOpened:s,onHamburgerClick:i})]}):Object(a.jsx)(_.b,{to:u,className:"header__link",children:r})]})};var N=function(e){var t=s.a.useContext(m),n=e.card,c=e.index,i=e.onCardClick,o=e.onCardLike,r=e.onCardDelete,u=n.likes.some((function(e){return e===t._id}))?"element__like_active":"",l=n.owner===t._id?"element__trash_active":"";return Object(a.jsxs)("article",{className:"element",children:[Object(a.jsx)("img",{src:n.link,alt:n.name,className:"element__img",onClick:function(){i(n)}}),Object(a.jsx)("button",{type:"button","aria-label":"\u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443",className:"element__trash ".concat(l),onClick:function(){r(n)}}),Object(a.jsxs)("div",{className:"element__item",children:[Object(a.jsx)("h2",{className:"element__text",children:n.name}),Object(a.jsxs)("div",{className:"element__like-block",children:[Object(a.jsx)("button",{type:"button","aria-label":"\u043b\u0430\u0439\u043a",className:"element__like ".concat(u),onClick:function(){o(n)}}),Object(a.jsx)("span",{className:"element__count",children:n.likes.length})]})]})]},c)};var k=function(e){var t=s.a.useContext(m),n=e.cards,c=e.onEditProfile,i=e.onAddPlace,o=e.onEditAvatar,r=e.onCardClick,u=e.onCardLike,l=e.onCardDelete;return Object(a.jsxs)("main",{children:[Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsxs)("div",{className:"profile__avatar",children:[Object(a.jsx)("img",{src:t.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440",className:"profile__img"}),Object(a.jsx)("button",{className:"profile__button profile__button_open_editAvatarPopup",onClick:o})]}),Object(a.jsxs)("div",{className:"profile__info",children:[Object(a.jsx)("h1",{className:"profile__name",children:t.name}),Object(a.jsx)("button",{type:"button","aria-label":"\u043a\u043d\u043e\u043f\u043a\u0430-\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f",className:"profile__button profile__button_open_editProfilePopup",onClick:c}),Object(a.jsx)("p",{className:"profile__working",children:t.about})]}),Object(a.jsx)("button",{type:"button","aria-label":"\u043a\u043d\u043e\u043f\u043a\u0430-\u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f",className:"profile__button profile__button_open_addPlacePopup",onClick:i})]}),Object(a.jsx)("section",{className:"elements",children:n.length?n.map((function(e){return Object(a.jsx)(N,{card:e,onCardClick:r,onCardLike:u,onCardDelete:l},e._id)})):null})]})},S=n(6),y=n(3);var w=function(e){var t=e.elementName,n=e.children,c=e.title,s=e.buttonSubmitText,i=e.buttonSubmitTextIsLoading,o=e.noConfirm,r=e.isOpen,u=e.onClose,l=e.isLoading,d=e.disabled,p=e.onSubmit,b=e.isPopup,m=void 0===b||b,j=e.isForm,h=void 0===j||j,O=e.path,f=e.entranceText,x=e.entranceLinkText;return Object(a.jsxs)("div",{className:m?"popup popup_type_".concat(t," ").concat(r?"popup_is-opened":""):t,children:[m&&Object(a.jsx)("button",{type:"button","aria-label":"\u0437\u0430\u043a\u0440\u044b\u0442\u044c \u043f\u043e\u043f\u0430\u043f",className:"popup__close popup__close_type_".concat(t),onClick:u}),h?Object(a.jsxs)("form",{className:m?"popup__form popup__form_type_".concat(t):"form",name:t,onSubmit:p,children:[Object(a.jsx)("h2",{className:m?"popup__heading":"form__heading",children:c}),n,m?Object(a.jsx)("button",{type:"submit",className:"popup__button ".concat(d?"popup__button_disabled":""),disabled:d,children:l?i:s}):!o&&Object(a.jsxs)("div",{className:"form__button-overlay",children:[Object(a.jsx)("button",{type:"submit",className:"form__button ".concat("form__button_disabled"),disabled:d,children:s}),Object(a.jsxs)("div",{className:"form__subtext",children:[f," ",Object(a.jsx)(_.b,{to:O,className:"form__link",children:x})]})]})]}):Object(a.jsx)("div",{className:"popup__container popup__container_type_".concat(t),children:n})]})};var L=function(e){var t=s.a.useContext(m),n=e.isOpen,c=e.onClose,i=e.isLoading,o=e.onUpdateUser,r=s.a.useState({}),u=Object(p.a)(r,2),l=u[0],d=u[1],b=s.a.useState({}),j=Object(p.a)(b,2),h=j[0],O=j[1],f=s.a.useState({name:!0,description:!0}),_=Object(p.a)(f,2),x=_[0],g=_[1],v=s.a.useState(!0),C=Object(p.a)(v,2),N=C[0],k=C[1];function L(e){var t,n=e.target,a=n.value,c=n.name;d(Object(y.a)(Object(y.a)({},l),{},Object(S.a)({},c,a))),t=n,g(Object(y.a)(Object(y.a)({},x),{},Object(S.a)({},t.name,t.validity.valid))),O(Object(y.a)(Object(y.a)({},h),{},Object(S.a)({},t.name,t.validationMessage))),x.name&&x.description?k(!1):k(!0)}return s.a.useEffect((function(){k(!0),d({name:t.name,description:t.about}),g({name:!0,description:!0}),O("")}),[n,t]),s.a.useEffect((function(){x.name&&x.description?k(!1):k(!0)}),[x.name,x.description]),Object(a.jsxs)(w,{elementName:"editProfile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",buttonSubmitText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",buttonSubmitTextIsLoading:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...",isOpen:n,onClose:c,isLoading:i,disabled:N,onSubmit:function(e){e.preventDefault(),o({name:l.name,about:l.description})},children:[Object(a.jsx)("input",{type:"text",name:"name",value:l.name||"",placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",className:"popup__input",minLength:"2",maxLength:"40",required:!0,onChange:L}),Object(a.jsx)("span",{className:"popup__error ".concat(x.name?"":"popup__error_visible"),children:h.name}),Object(a.jsx)("input",{type:"text",name:"description",value:l.description||"",placeholder:"\u0420\u0430\u0441\u0441\u043a\u0430\u0436\u0438\u0442\u0435 \u043e \u0441\u0435\u0431\u0435",className:"popup__input",minLength:"2",maxLength:"200",required:!0,onChange:L}),Object(a.jsx)("span",{className:"popup__error ".concat(x.description?"":"popup__error_visible"),children:h.description})]})};var P=function(e){var t=s.a.useRef(""),n=e.isOpen,c=e.onClose,i=e.isLoading,o=e.onUpdateAvatar,r=s.a.useState(""),u=Object(p.a)(r,2),l=u[0],d=u[1],b=s.a.useState(!0),m=Object(p.a)(b,2),j=m[0],h=m[1],O=s.a.useState(!0),f=Object(p.a)(O,2),_=f[0],x=f[1];return s.a.useEffect((function(){x(!0),t.current.value="",h(!0),d("")}),[n]),s.a.useEffect((function(){x(!j)}),[j]),Object(a.jsxs)(w,{elementName:"editAvatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonSubmitText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",buttonSubmitTextIsLoading:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...",isOpen:n,onClose:c,isLoading:i,disabled:_,onSubmit:function(e){e.preventDefault(),o(t.current.value)},children:[Object(a.jsx)("input",{ref:t,type:"url",name:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u0443",className:"popup__input",required:!0,onChange:function(){h(t.current.validity.valid),d(t.current.validationMessage),x(!j)}}),Object(a.jsx)("span",{className:"popup__error ".concat(j?"":"popup__error_visible"),children:l})]})};var T=function(e){var t=e.isOpen,n=e.onClose,c=e.isLoading,i=e.onAddPlace,o=s.a.useState({name:"",url:""}),r=Object(p.a)(o,2),u=r[0],l=r[1],d=s.a.useState({}),b=Object(p.a)(d,2),m=b[0],j=b[1],h=s.a.useState({name:!0,url:!0}),O=Object(p.a)(h,2),f=O[0],_=O[1],x=s.a.useState({name:!1,url:!1}),g=Object(p.a)(x,2),v=g[0],C=g[1],N=s.a.useState(!0),k=Object(p.a)(N,2),L=k[0],P=k[1];function T(e){var t,n=e.target,a=n.value,c=n.name;l(Object(y.a)(Object(y.a)({},u),{},Object(S.a)({},c,a))),t=n,_(Object(y.a)(Object(y.a)({},f),{},Object(S.a)({},t.name,t.validity.valid))),j(Object(y.a)(Object(y.a)({},m),{},Object(S.a)({},t.name,t.validationMessage))),C(Object(y.a)(Object(y.a)({},v),{},Object(S.a)({},t.name,t.validity.valid))),v.name&&v.url?P(!1):P(!0)}return s.a.useEffect((function(){P(!0),l({name:"",url:""}),_({name:!0,url:!0}),C({name:!1,url:!1}),j("")}),[t]),s.a.useEffect((function(){v.name&&v.url?P(!1):P(!0)}),[v.name,v.url]),Object(a.jsxs)(w,{elementName:"addPlace",isPopup:!0,title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonSubmitText:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",buttonSubmitTextIsLoading:"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435...",isOpen:t,onClose:n,isLoading:c,disabled:L,onSubmit:function(e){e.preventDefault(),i({name:u.name,link:u.url})},children:[Object(a.jsx)("input",{type:"text",name:"name",value:u.name,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__input",minLength:"2",maxLength:"30",required:!0,onChange:T}),Object(a.jsx)("span",{className:"popup__error ".concat(f.name?"":"popup__error_visible"),children:m.name}),Object(a.jsx)("input",{type:"url",name:"url",value:u.url,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u0443",className:"popup__input",required:!0,onChange:T}),Object(a.jsx)("span",{className:"popup__error ".concat(f.url?"":"popup__error_visible"),children:m.url})]})};var E=function(e){var t=e.isOpen,n=e.onClose,c=e.isLoading,s=e.onConfirmDelete;return Object(a.jsx)(w,{elementName:"deleteCurrentCard",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonSubmitText:"\u0414\u0430",buttonSubmitTextIsLoading:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435...",isOpen:t,onClose:n,isLoading:c,onSubmit:function(e){e.preventDefault(),s()}})};var I=function(e){var t=e.link,n=e.name,c=e.isOpen,s=e.onClose;return Object(a.jsx)("div",{className:"popup popup_type_modalImage ".concat(c?"popup_is-opened":""),children:Object(a.jsxs)("figure",{className:"popup__figure",children:[Object(a.jsx)("button",{type:"button","aria-label":"\u0437\u0430\u043a\u0440\u044b\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",className:"popup__close popup__close_type_modalImage",onClick:s}),Object(a.jsx)("img",{src:t,alt:n,className:"popup__img popup__img_type_modalImage"}),Object(a.jsx)("figcaption",{className:"popup__text popup__text_type_modalImage",children:n})]})})};var A=function(){return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsx)("p",{className:"footer__text",children:"\xa9 2021 Mesto Russia"})})};var U=function(e){var t=e.title,n=e.buttonSubmitText,i=e.path,o=e.entranceText,r=e.entranceLinkText,u=e.onSubmit,l=e.autoCompleteEmail,d=e.autoCompletePassword,b=Object(c.useState)({email:"",password:""}),m=Object(p.a)(b,2),j=m[0],h=m[1],O=Object(c.useState)({}),f=Object(p.a)(O,2),_=f[0],x=f[1],g=Object(c.useState)({email:!0,password:!0}),v=Object(p.a)(g,2),C=v[0],N=v[1],k=Object(c.useState)({email:!1,password:!1}),L=Object(p.a)(k,2),P=L[0],T=L[1],E=Object(c.useState)(!0),I=Object(p.a)(E,2),A=I[0],U=I[1],D=Object(c.useState)("password"),q=Object(p.a)(D,2),R=q[0],J=q[1],H=Object(c.useState)("hidden"),M=Object(p.a)(H,2),F=M[0],B=M[1];function W(e){var t,n=e.target,a=n.value,c=n.name;h(Object(y.a)(Object(y.a)({},j),{},Object(S.a)({},c,a))),t=n,N(Object(y.a)(Object(y.a)({},C),{},Object(S.a)({},t.name,t.validity.valid))),x(Object(y.a)(Object(y.a)({},_),{},Object(S.a)({},t.name,t.validationMessage))),T(Object(y.a)(Object(y.a)({},P),{},Object(S.a)({},t.name,t.validity.valid))),P.email&&P.password?U(!1):U(!0)}return s.a.useEffect((function(){P.email&&P.password?U(!1):U(!0)}),[P.email,P.password]),Object(a.jsxs)(w,{elementName:"entrance",title:t,buttonSubmitText:n,isPopup:!1,path:i,entranceText:o,entranceLinkText:r,onSubmit:function(e){e.preventDefault(),(j.email||j.password)&&(u(j.password,j.email),h({email:"",password:""}))},disabled:A,children:[Object(a.jsxs)("label",{htmlFor:"email",className:"form__field",children:[Object(a.jsx)("input",{type:"email",className:"form__input",id:"email",name:"email",value:j.email||"",placeholder:"Email",minLength:"6",maxLength:"40",autoComplete:l,required:!0,onChange:W}),Object(a.jsx)("span",{className:"form__error ".concat(!C.email&&"form__error_visible"),id:"email-error",children:_.email})]}),Object(a.jsxs)("label",{htmlFor:"password",className:"form__field",children:[Object(a.jsx)("input",{type:R,className:"form__input",id:"password",name:"password",value:j.password||"",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",minLength:"8",maxLength:"30",autoComplete:d,required:!0,onChange:W}),Object(a.jsx)("button",{type:"button",className:"form__button_type_password-".concat(F),onClick:function(){"password"===R?(J("text"),B("hidden")):(J("password"),B("showed"))},onKeyDown:function(e){return e.preventDefault}}),Object(a.jsx)("span",{className:"form__error ".concat(!C.password&&"form__error_visible"),id:"password-error",children:_.password})]})]})};var D=function(e){var t=e.onLogin;return Object(a.jsx)(U,{title:"\u0412\u0445\u043e\u0434",buttonSubmitText:"\u0412\u043e\u0439\u0442\u0438",path:"/sign-up",onSubmit:function(e,n){t(e,n)},autoCompleteEmail:"email",autoCompletePassword:"current-password"})};var q=function(e){var t=e.onRegister;return Object(a.jsx)(U,{title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",buttonSubmitText:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",path:"/sign-in",entranceText:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?",entranceLinkText:"\u0412\u043e\u0439\u0442\u0438",onSubmit:function(e,n){t(e,n)}})},R=n(34),J=function(e){var t=e.component,n=Object(R.a)(e,["component"]);return Object(a.jsx)(b.b,{children:function(){return n.loggedIn?Object(a.jsx)(t,Object(y.a)({},n)):Object(a.jsx)(b.a,{to:"/sign-in"})}})};var H=function(e){var t=e.isOpen,n=e.onClose,c=e.loggedIn,s=e.message;return Object(a.jsxs)(w,{elementName:"infoTooltip",isForm:!1,noConfirm:!0,isOpen:t,onClose:n,loggedIn:c,children:[Object(a.jsx)("img",{src:s.iconPath,alt:"\u0418\u043a\u043e\u043d\u043a\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438",className:"popup__icon"}),Object(a.jsx)("h2",{className:"popup__heading popup__heading_type_infoTooltip",children:s.text})]})},M=n(19),F=n(21),B=n(22),W=function(e){Object(M.a)(n,e);var t=Object(F.a)(n);function n(e){var a;Object(j.a)(this,n);for(var c=arguments.length,s=new Array(c>1?c-1:0),i=1;i<c;i++)s[i-1]=arguments[i];return(a=t.call.apply(t,[this].concat(s))).status=400,a.message=e,a}return n}(Object(B.a)(Error)),G=function(e){Object(M.a)(n,e);var t=Object(F.a)(n);function n(e){var a;Object(j.a)(this,n);for(var c=arguments.length,s=new Array(c>1?c-1:0),i=1;i<c;i++)s[i-1]=arguments[i];return(a=t.call.apply(t,[this].concat(s))).status=401,a.message=e,a}return n}(Object(B.a)(Error)),K=function(e,t){return fetch("".concat(O.baseUrl,"signin"),{method:"POST",headers:O.headers,credentials:O.credentials,body:JSON.stringify({password:e,email:t})}).then((function(e){return e.ok?e.json():Promise.reject(e)})).catch((function(e){if(400===e.status)throw new W("\u041d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043e \u043e\u0434\u043d\u043e \u0438\u0437 \u043f\u043e\u043b\u0435\u0439");if(401===e.status)throw new G("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 \u0442\u0430\u043a\u0438\u043c email \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d");throw Error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))},$=function(){return fetch("".concat(O.baseUrl,"logout"),{method:"DELETE"}).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a!"))})).catch((function(e){console.log(e)}))};var z=function(e){var t=e.email,n=e.signOut,c=e.isAuthInfoOpened,s="header__auth-info-mobile\n\t".concat(c?"header__auth-info-mobile_opened":"header__auth-info-mobile_closed");return Object(a.jsxs)("div",{className:s,children:[Object(a.jsx)("span",{className:"header__mail",children:t}),Object(a.jsx)("button",{className:"header__button",onClick:n,children:"\u0412\u044b\u0439\u0442\u0438"})]})},Q=n.p+"static/media/resolve.995328b5.svg",V=n.p+"static/media/reject.4190bc4f.svg",X=n.p+"static/media/loader.39e38019.svg";var Y=function(){var e=Object(c.useState)(!1),t=Object(p.a)(e,2),i=t[0],o=t[1],r=Object(c.useState)(""),j=Object(p.a)(r,2),h=j[0],_=j[1],x=Object(c.useState)(!1),g=Object(p.a)(x,2),v=g[0],N=g[1],S=Object(c.useState)(!1),y=Object(p.a)(S,2),w=y[0],U=y[1],R=Object(c.useState)(!1),M=Object(p.a)(R,2),F=M[0],B=M[1],Y=Object(c.useState)(!1),Z=Object(p.a)(Y,2),ee=Z[0],te=Z[1],ne=Object(c.useState)({isImageOpen:!1,link:"",name:""}),ae=Object(p.a)(ne,2),ce=ae[0],se=ae[1],ie=Object(c.useState)([]),oe=Object(p.a)(ie,2),re=oe[0],ue=oe[1],le=Object(c.useState)({}),de=Object(p.a)(le,2),pe=de[0],be=de[1],me=Object(c.useState)(!1),je=Object(p.a)(me,2),he=je[0],Oe=je[1],fe=Object(c.useState)({}),_e=Object(p.a)(fe,2),xe=_e[0],ge=_e[1],ve=Object(c.useState)(),Ce=Object(p.a)(ve,2),Ne=Ce[0],ke=Ce[1],Se=Object(c.useState)(!1),ye=Object(p.a)(Se,2),we=ye[0],Le=ye[1],Pe=Object(c.useState)({iconPath:X,text:""}),Te=Object(p.a)(Pe,2),Ee=Te[0],Ie=Te[1],Ae=Object(b.h)(),Ue=Object(b.g)(),De=n(46);function qe(){return(qe=Object(d.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(De(t),n).then((function(){o(!0),Ue.push("/"),Ie({iconPath:Q,text:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043b\u0438\u0441\u044c"})})).catch((function(e){return Ie({iconPath:V,text:e.message})}));case 2:te(!0);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Re(){return Je.apply(this,arguments)}function Je(){return(Je=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$();case 2:o(!1),_(""),Ue.push("/sign-in");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function He(){N(!1),B(!1),U(!1),se({isImageOpen:!1,link:"",name:""}),Oe(!1),te(!1),Ie({iconPath:X,text:""})}return s.a.useEffect((function(){i&&f.getUserInfo().then((function(e){be(e)})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435: ".concat(e))}))}),[i]),s.a.useEffect((function(){i&&f.getInitialCards().then((function(e){ue(e)})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u043a\u0430\u0440\u0442\u043e\u0447\u0435\u043a: ".concat(e))}))}),[i]),s.a.useEffect((function(){try{fetch("".concat(O.baseUrl,"users/me"),{method:"GET",headers:O.headers,credentials:O.credentials}).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))})).catch((function(e){throw new G(e.message)})).then((function(e){_(e.email)}))&&(Ue.push("/"),o(!0))}catch(e){o(!1),Ue.push("/sign-in")}}),[Ue]),Object(a.jsx)(m.Provider,{value:pe,children:Object(a.jsxs)("div",{className:"page",children:[i&&we&&Object(a.jsx)(z,{email:h,signOut:Re,isAuthInfoOpened:we}),Object(a.jsx)(C,{loggedIn:i,locaction:Ae,email:h,signOut:Re,isAuthInfoOpened:we,onHamburgerClick:function(){Le(!we)}}),Object(a.jsxs)(b.d,{children:[Object(a.jsx)(J,{exact:!0,path:"/",loggedIn:i,component:k,cards:re,onCardClick:function(e){var t=e.link,n=e.name;se({isImageOpen:!0,link:t,name:n})},onCardLike:function(e){var t=e.likes.some((function(e){return e===pe._id}));f.changeLikeCardStatus(e._id,!t).then((function(t){var n=re.map((function(n){return n._id===e._id?t:n}));ue(n)})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043f\u044b\u0442\u043a\u0435 \u043f\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c/\u0441\u043d\u044f\u0442\u044c \u043b\u0430\u0439\u043a: ".concat(e))}))},onCardDelete:function(e){Oe(!0),ge(e)},onEditProfile:function(){N(!0)},onAddPlace:function(){U(!0)},onEditAvatar:function(){B(!0)}}),Object(a.jsx)(b.b,{path:"/sign-in",children:Object(a.jsx)(D,{onLogin:function(e,t){return qe.apply(this,arguments)}})}),Object(a.jsx)(b.b,{path:"/sign-up",children:Object(a.jsx)(q,{onRegister:function(e,t){(function(e,t){return fetch("".concat(O.baseUrl,"signup"),{method:"POST",headers:O.headers,body:JSON.stringify({password:e,email:t})}).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a!\n\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."))})).catch((function(e){throw new W(e.message)}))})(De(e),t).then((function(){Ie({iconPath:Q,text:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!"}),Ue.push("/sing-in")})).catch((function(e){return Ie({iconPath:V,text:e.message})})),te(!0)}})}),Object(a.jsx)(b.b,{children:i?Object(a.jsx)(b.a,{to:"/"}):Object(a.jsx)(b.a,{to:"/sign-in"})})]}),Object(a.jsx)(A,{}),Object(a.jsx)(H,{isOpen:ee,onClose:He,loggedIn:i,message:Ee}),Object(a.jsx)(L,{isOpen:v,onClose:He,onUpdateUser:function(e){ke(!0),f.updateUserInfo(e).then((function(e){be(e),He()})).catch((function(e){return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435: ".concat(e)})).finally((function(){return ke(!1)}))},isLoading:Ne}),Object(a.jsx)(P,{isOpen:F,onClose:He,onUpdateAvatar:function(e){ke(!0),f.updateUserAvatar(e).then((function(e){be(e),He()})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0430\u0432\u0430\u0442\u0430\u0440\u0430: ".concat(e))})).finally((function(){return ke(!1)}))},isLoading:Ne}),Object(a.jsx)(T,{isOpen:w,onClose:He,onAddPlace:function(e){ke(!0),f.addNewCard(e).then((function(e){ue([e].concat(Object(l.a)(re))),He()})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u043d\u043e\u0432\u043e\u0439 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438: ".concat(e))})).finally((function(){return ke(!1)}))}}),Object(a.jsx)(E,{isOpen:he,onClose:He,onConfirmDelete:function(){f.deleteCard(xe._id).then((function(){ue(re.filter((function(e){return e!==xe}))),He()})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438: ".concat(e))}))}}),Object(a.jsx)(I,{name:ce.name,link:ce.link,onClose:He,isOpen:ce.isImageOpen})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(_.a,{basename:"/",children:Object(a.jsx)(Y,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[47,1,2]]]);
//# sourceMappingURL=main.e8cd3335.chunk.js.map